<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farm Financial Intelligence Platform - USDA ARMS Data</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header>
        <div class="container">
            <h1>ðŸŒ¾ Farm Financial Intelligence Platform</h1>
            <p>Analyze U.S. farm financial performance using USDA Agricultural Resource Management Survey (ARMS) data</p>
        </div>
    </header>

    <main class="container">
        <!-- Tab Navigation -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="income">Income Statement</button>
            <button class="tab-btn" data-tab="balance">Balance Sheet</button>
            <button class="tab-btn" data-tab="ratios">Financial Ratios</button>
            <button class="tab-btn" data-tab="compare">Compare Analysis</button>
            <button class="tab-btn" data-tab="structure">Farm Structure</button>
        </div>

        <!-- Income Statement Tab -->
        <div id="income-tab" class="tab-content active">
            <h2>Farm Business Income Statement</h2>
            <p class="description">View revenue, expenses, and net farm income data across different years and farm types.</p>
            
            <div class="filter-section">
                <div class="form-group">
                    <label for="income-years">Select Years (Ctrl+Click for multiple):</label>
                    <select id="income-years" multiple size="6">
                        <!-- Will be populated dynamically -->
                    </select>
                    <small>Hold Ctrl/Cmd to select multiple years</small>
                </div>
                
                <div class="form-group">
                    <label for="income-state">State:</label>
                    <select id="income-state">
                        <option value="all">All States</option>
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="income-category">Category:</label>
                    <select id="income-category">
                        <option value="">None</option>
                        <option value="collapsed farm typology">Farm Typology</option>
                        <option value="economic class">Economic Class</option>
                        <option value="nass region">NASS Region</option>
                        <option value="operator age">Operator Age</option>
                    </select>
                </div>
                
                <button onclick="fetchIncomeStatement()" class="btn-primary">Analyze Income Statement</button>
            </div>
            
            <div id="income-loading" class="loading hidden">
                <div class="spinner"></div>
                <p>Loading data from USDA...</p>
            </div>
            <div id="income-error" class="error hidden"></div>
            
            <div id="income-results" class="results-section">
                <div class="results-header">
                    <h3>Results</h3>
                    <div class="search-box">
                        <input type="text" id="income-search" placeholder="ðŸ” Search in results..." onkeyup="searchTable('income-table', 'income-search')">
                    </div>
                </div>
                <div class="table-container">
                    <table id="income-table" class="data-table">
                        <thead id="income-thead"></thead>
                        <tbody id="income-tbody"></tbody>
                    </table>
                </div>
                <div id="income-summary" class="data-summary"></div>
            </div>
        </div>

        <!-- Balance Sheet Tab -->
        <div id="balance-tab" class="tab-content">
            <h2>Farm Business Balance Sheet</h2>
            <p class="description">Analyze assets, liabilities, and net worth of farm operations.</p>
            
            <div class="filter-section">
                <div class="form-group">
                    <label for="balance-years">Select Years:</label>
                    <select id="balance-years" multiple size="6">
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="balance-state">State:</label>
                    <select id="balance-state">
                        <option value="all">All States</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="balance-category">Category:</label>
                    <select id="balance-category">
                        <option value="">None</option>
                        <option value="collapsed farm typology">Farm Typology</option>
                        <option value="economic class">Economic Class</option>
                        <option value="nass region">NASS Region</option>
                    </select>
                </div>
                
                <button onclick="fetchBalanceSheet()" class="btn-primary">Analyze Balance Sheet</button>
            </div>
            
            <div id="balance-loading" class="loading hidden">
                <div class="spinner"></div>
                <p>Loading data from USDA...</p>
            </div>
            <div id="balance-error" class="error hidden"></div>
            
            <div id="balance-results" class="results-section">
                <div class="results-header">
                    <h3>Results</h3>
                    <div class="search-box">
                        <input type="text" id="balance-search" placeholder="ðŸ” Search in results..." onkeyup="searchTable('balance-table', 'balance-search')">
                    </div>
                </div>
                <div class="table-container">
                    <table id="balance-table" class="data-table">
                        <thead id="balance-thead"></thead>
                        <tbody id="balance-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Financial Ratios Tab -->
        <div id="ratios-tab" class="tab-content">
            <h2>Farm Business Financial Ratios</h2>
            <p class="description">Evaluate profitability, liquidity, and solvency ratios for farm performance assessment.</p>
            
            <div class="filter-section">
                <div class="form-group">
                    <label for="ratios-years">Select Years:</label>
                    <select id="ratios-years" multiple size="6">
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="ratios-state">State:</label>
                    <select id="ratios-state">
                        <option value="all">All States</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="ratios-category">Category:</label>
                    <select id="ratios-category">
                        <option value="">None</option>
                        <option value="collapsed farm typology">Farm Typology</option>
                        <option value="economic class">Economic Class</option>
                    </select>
                </div>
                
                <button onclick="fetchFinancialRatios()" class="btn-primary">View Financial Ratios</button>
            </div>
            
            <div id="ratios-loading" class="loading hidden">
                <div class="spinner"></div>
                <p>Loading data from USDA...</p>
            </div>
            <div id="ratios-error" class="error hidden"></div>
            
            <div id="ratios-results" class="results-section">
                <div class="results-header">
                    <h3>Results</h3>
                    <div class="search-box">
                        <input type="text" id="ratios-search" placeholder="ðŸ” Search in results..." onkeyup="searchTable('ratios-table', 'ratios-search')">
                    </div>
                </div>
                <div class="table-container">
                    <table id="ratios-table" class="data-table">
                        <thead id="ratios-thead"></thead>
                        <tbody id="ratios-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Compare Analysis Tab -->
        <div id="compare-tab" class="tab-content">
            <h2>Comparative Analysis</h2>
            <p class="description">Compare farm performance across different categories and classifications.</p>
            
            <div class="filter-section">
                <div class="form-group">
                    <label for="compare-year">Select Year:</label>
                    <select id="compare-year">
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="compare-report">Report Type:</label>
                    <select id="compare-report">
                        <option value="farm business income statement">Income Statement</option>
                        <option value="farm business balance sheet">Balance Sheet</option>
                        <option value="farm business financial ratios">Financial Ratios</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="compare-type">Compare By:</label>
                    <select id="compare-type">
                        <option value="typology">Farm Typology</option>
                        <option value="economic">Economic Class</option>
                        <option value="region">NASS Region</option>
                    </select>
                </div>
                
                <button onclick="performComparison()" class="btn-primary">Compare</button>
            </div>
            
            <div id="compare-loading" class="loading hidden">
                <div class="spinner"></div>
                <p>Loading comparison data...</p>
            </div>
            <div id="compare-error" class="error hidden"></div>
            
            <div id="compare-results" class="results-section">
                <div class="results-header">
                    <h3>Comparison Results</h3>
                </div>
                <div class="table-container">
                    <table id="compare-table" class="data-table">
                        <thead id="compare-thead"></thead>
                        <tbody id="compare-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Farm Structure Tab -->
        <div id="structure-tab" class="tab-content">
            <h2>Farm Structural Characteristics</h2>
            <p class="description">Explore farm size, acreage, production specialties, and operational characteristics.</p>
            
            <div class="filter-section">
                <div class="form-group">
                    <label for="structure-years">Select Years:</label>
                    <select id="structure-years" multiple size="6">
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="structure-state">State:</label>
                    <select id="structure-state">
                        <option value="all">All States</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="structure-category">Category:</label>
                    <select id="structure-category">
                        <option value="">None</option>
                        <option value="production specialty">Production Specialty</option>
                        <option value="farm resource region">Farm Resource Region</option>
                    </select>
                </div>
                
                <button onclick="fetchStructuralCharacteristics()" class="btn-primary">View Farm Structure</button>
            </div>
            
            <div id="structure-loading" class="loading hidden">
                <div class="spinner"></div>
                <p>Loading data from USDA...</p>
            </div>
            <div id="structure-error" class="error hidden"></div>
            
            <div id="structure-results" class="results-section">
                <div class="results-header">
                    <h3>Results</h3>
                    <div class="search-box">
                        <input type="text" id="structure-search" placeholder="ðŸ” Search in results..." onkeyup="searchTable('structure-table', 'structure-search')">
                    </div>
                </div>
                <div class="table-container">
                    <table id="structure-table" class="data-table">
                        <thead id="structure-thead"></thead>
                        <tbody id="structure-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Data Source</h4>
                    <p>Data provided by <a href="https://www.ers.usda.gov/" target="_blank">USDA Economic Research Service (ERS)</a></p>
                    <p>Agricultural Resource Management Survey (ARMS)</p>
                </div>
                <div class="footer-section">
                    <h4>About</h4>
                    <p>This platform helps farmers, agricultural consultants, and researchers analyze farm financial performance and make data-driven decisions.</p>
                </div>
                <div class="footer-section">
                    <h4>API Documentation</h4>
                    <p><a href="https://www.ers.usda.gov/developer/data-apis/arms-data-api/" target="_blank">USDA ARMS API Docs</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Farm Financial Intelligence Platform | Educational Project</p>
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
